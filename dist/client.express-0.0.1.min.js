// client.express.js JavaScript Routing, version: 0.0.1
// (c) 2011 Mark Nijhof
//
//  Released under MIT license.
//
ClientExpress={};ClientExpress.createServer=function(){return new ClientExpress.Server};ClientExpress.supported=function(){return typeof window.history.pushState=="function"};
ClientExpress.Server=function(){function c(h,a,c,f){d.registerRoute(a,c,f);return h}var d,e,f=function(){d=new ClientExpress.Router;e=new ClientExpress.EventListener},a=f.prototype;a.version=function(){return"0.0.1"};a.router=function(){return d};a.get=function(a,b){return c(this,"get",a,b)};a.post=function(a,b){return c(this,"post",a,b)};a.put=function(a,b){return c(this,"put",a,b)};a.del=function(a,b){return c(this,"del",a,b)};a.listen=function(){e.registerEventHandlers()};a.processRequest=function(a){var b=
d.match(a.path);if(!b.resolved())return!1;var c=new ClientExpress.Response(a);b.action(a,c);return processResponse(c)};a.processResponse=function(a){console.log("processing: "+a)};return f}();
ClientExpress.Route=function(c,d,e,f){this.resolved=function(){return!0};this.method=c;this.path=d;this.action=e;this.regexp=function(a,c,b){if(a instanceof RegExp)return a;a=a.concat("/?").replace(/\/\(/g,"(?:/").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?/g,function(a,b,f,d,e,g){c.push({name:d,optional:!!g});b=b||"";return""+(g?"":b)+"(?:"+(g?b:"")+(f||"")+(e||"([^/]+?)")+")"+(g||"")}).replace(/([\/.])/g,"\\$1").replace(/\*/g,"(.+)");return RegExp("^"+a+"$",b?"":"i")}(d,this.keys=[],f.sensitive)};
ClientExpress.Route.prototype.match=function(c){return this.regexp.exec(c)};ClientExpress.Router=function(){var c,d=function(){c={get:[],post:[],put:[],del:[]}},e=d.prototype;e.match=function(f,a){for(var d=c[f].length,b=0;b<d;++b){var e=c[f][b];if(e.match(a))return e}return{resolved:function(){return!1}}};e.registerRoute=function(d,a,e){c[d].push(new ClientExpress.Route(d,a,e,{sensitive:!1}))};return d}();
